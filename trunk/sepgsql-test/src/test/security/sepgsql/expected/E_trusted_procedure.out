--
-- SE-PostgreSQL testcases : trusted procedure
--
-- selinux_user: unconfined_u
-- selinux_role: unconfined_r
-- selinux_type: sepgsql_test_t
-- selinux_range: s0
SELECT * FROM e1;	-- to be failed
psql:./E_trusted_procedure.sql:9: ERROR:  SELinux: denied { select } scontext=unconfined_u:unconfined_r:sepgsql_test_t:s0 tcontext=system_u:object_r:sepgsql_secret_table_t:s0 tclass=db_column name=e1.tag
SELECT id, E2(id) FROM e1;
 id |  e2  
----+------
 10 | abcd
 20 | efgh
(2 rows)

SELECT sepgsql_getcon();
               sepgsql_getcon                
---------------------------------------------
 unconfined_u:unconfined_r:sepgsql_test_t:s0
(1 row)

SELECT e3();
                         e3                          
-----------------------------------------------------
 unconfined_u:unconfined_r:sepgsql_trusted_proc_t:s0
(1 row)

